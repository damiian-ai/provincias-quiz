<!DOCTYPE html>

<html lang="es">

<head>

Â Â <meta charset="utf-8" />

Â Â <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />

Â Â <title>Provincias de Argentina â€“ Juego</title>

Â Â <meta name="theme-color" content="#0ea5e9">

Â Â <style>

Â Â Â Â :root {

Â Â Â Â Â Â --ok: #22c55e;

Â Â Â Â Â Â --bad: #ef4444;

Â Â Â Â Â Â --idle: #f1f5f9;

Â Â Â Â Â Â --line: #1e293b;

Â Â Â Â Â Â --line-strong: #0f172a;

Â Â Â Â Â Â --accent: #0ea5e9;

Â Â Â Â }

Â Â Â Â * { box-sizing: border-box; }

Â Â Â Â body {

Â Â Â Â Â Â margin: 0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu,

Â Â Â Â Â Â Cantarell, "Helvetica Neue", Arial, "Noto Sans";

Â Â Â Â Â Â background: #f8fafc; color: #0f172a;

Â Â Â Â }

Â Â Â Â .wrap { max-width: 1000px; margin: 0 auto; padding: 16px; display: grid; gap: 16px; }

Â Â Â Â header h1 { margin: 0 0 6px; font-size: 1.35rem; }

Â Â Â Â header p { margin: 0; color: #475569; font-size: .95rem; }

Â Â Â Â .card {

Â Â Â Â Â Â background: #fff; border: 1px solid #e2e8f0; border-radius: 16px;

Â Â Â Â Â Â padding: 14px 14px 10px; box-shadow: 0 4px 16px rgba(2,6,23,.04);

Â Â Â Â }

Â Â Â Â .grid { display: grid; gap: 16px; }

Â Â Â Â @media (min-width: 900px) { .grid { grid-template-columns: 2fr 1fr; } }

Â Â Â Â .mapBox {

Â Â Â Â Â Â width: 100%; aspect-ratio: 4/5;

Â Â Â Â Â Â border-radius: 12px; overflow: hidden; border: 1px solid #cbd5e1; background: white; position: relative;

Â Â Â Â }

Â Â Â Â svg { width: 100%; height: 100%; display: block; touch-action: none; }

Â Â Â Â .legend { display: flex; gap: 12px; align-items: center; margin-top: 8px; color: #475569; font-size: .9rem; }

Â Â Â Â .dot { width: 12px; height: 12px; border-radius: 3px; display: inline-block; vertical-align: middle; }

Â Â Â Â .row { display: flex; gap: 8px; }

Â Â Â Â input[type="text"], input[type="url"] {

Â Â Â Â Â Â width: 100%; padding: 10px 12px; border-radius: 12px;

Â Â Â Â Â Â border: 1px solid #cbd5e1; outline: none; font-size: 1rem;

Â Â Â Â }

Â Â Â Â input[type="file"] { font-size: .95rem; }

Â Â Â Â input:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(14,165,233,.2); }

Â Â Â Â button {

Â Â Â Â Â Â border: none; background: var(--accent); color: white; font-weight: 600;

Â Â Â Â Â Â padding: 10px 14px; border-radius: 12px; cursor: pointer;

Â Â Â Â }

Â Â Â Â button.ghost { background: white; color: #0f172a; border: 1px solid #cbd5e1; font-weight: 500; }

Â Â Â Â .muted { color: #475569; font-size: .9rem; }

Â Â Â Â .badge { display:inline-block; background:#ecfdf5; color:#065f46; padding:4px 8px; border-radius:10px; font-size:.9rem; font-weight:600; }

Â Â Â Â .msg { margin-top: 8px; color:#1f2937; font-size: .95rem; min-height: 1.2em; }

Â Â Â Â .zoomBtns { position:absolute; right:10px; top:10px; display:flex; flex-direction:column; gap:8px; z-index:10; }

Â Â Â Â .zoomBtns button { background: #ffffffcc; color:#0f172a; border:1px solid #cbd5e1; }

Â Â </style>

</head>

<body>

Â Â <div class="wrap">

Â Â Â Â <header class="card">

Â Â Â Â Â Â <h1>ðŸ‡¦ðŸ‡· Provincias de Argentina â€“ Juego</h1>

Â Â Â Â Â Â <p>1) TocÃ¡ una provincia del mapa. 2) EscribÃ­ su nombre. 3) Correcto = <b style="color:var(--ok)">verde</b>, incorrecto = <b style="color:var(--bad)">rojo</b>.</p>

Â Â Â Â </header>


Â Â Â Â <div class="grid">

Â Â Â Â Â Â <!-- Mapa -->

Â Â Â Â Â Â <section class="card">

Â Â Â Â Â Â Â Â <div id="map" class="mapBox">

Â Â Â Â Â Â Â Â Â Â <div class="zoomBtns">

Â Â Â Â Â Â Â Â Â Â Â Â <button id="btnPlus" aria-label="Acercar">+</button>

Â Â Â Â Â Â Â Â Â Â Â Â <button id="btnMinus" aria-label="Alejar">âˆ’</button>

Â Â Â Â Â Â Â Â Â Â Â Â <button id="btnReset" aria-label="Restablecer">âŸ³</button>

Â Â Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â <div class="legend">

Â Â Â Â Â Â Â Â Â Â <span><span class="dot" style="background:var(--ok)"></span> Correcta</span>

Â Â Â Â Â Â Â Â Â Â <span><span class="dot" style="background:var(--bad)"></span> Incorrecta</span>

Â Â Â Â Â Â Â Â Â Â <span><span class="dot" style="background:var(--idle)"></span> Sin responder</span>

Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â </section>


Â Â Â Â Â Â <!-- Controles -->

Â Â Â Â Â Â <aside class="card">

Â Â Â Â Â Â Â Â <div class="row">

Â Â Â Â Â Â Â Â Â Â <input id="answer" type="text" placeholder="Â¿CÃ³mo se llama la provincia?" autocomplete="off" />

Â Â Â Â Â Â Â Â Â Â <button id="checkBtn">Comprobar</button>

Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â <div class="row" style="margin-top:8px; gap: 12px; align-items:center;">

Â Â Â Â Â Â Â Â Â Â <span class="badge">Aciertos: <span id="hits">0</span>/<span id="total">--</span></span>

Â Â Â Â Â Â Â Â Â Â <button class="ghost" id="resetBtn">Reiniciar</button>

Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â <div id="msg" class="msg"></div>


Â Â Â Â Â Â Â Â <hr style="margin:12px 0; border:none; border-top:1px solid #e2e8f0;" />

Â Â Â Â Â Â Â Â <div class="muted" style="margin-bottom:6px;"><b>Opciones avanzadas</b></div>


Â Â Â Â Â Â Â Â <label class="muted" for="geoUrl">URL GeoJSON (recomendado)</label>

Â Â Â Â Â Â Â Â <div class="row" style="margin-top:6px;">

Â Â Â Â Â Â Â Â Â Â <input id="geoUrl" type="url" placeholder="PegÃ¡ la URL y toca Cargar" />

Â Â Â Â Â Â Â Â Â Â <button id="loadBtn">Cargar</button>

Â Â Â Â Â Â Â Â </div>

Â Â Â Â Â Â Â Â <div id="err" class="muted" style="margin-top:6px;color:#b91c1c;"></div>


Â Â Â Â Â Â Â Â <div class="muted" style="margin-top:10px;">Archivo local (.geojson / .json)</div>

Â Â Â Â Â Â Â Â <input id="geoFile" type="file" accept=".geojson,.json,application/json" />

Â Â Â Â Â Â </aside>

Â Â Â Â </div>


Â Â Â Â <footer class="muted" style="text-align:center;">

Â Â Â Â Â Â Hecho con D3. GeoJSON por defecto: Datos Argentina.

Â Â Â Â </footer>

Â Â </div>


Â Â <!-- D3 -->

Â Â <script src="https://unpkg.com/d3@7/dist/d3.min.js"></script>


Â Â <script>

Â Â // ========= Config =========

Â Â const DEFAULT_GEOJSON_URL = "https://apis.datos.gob.ar/georef/api/provincias?formato=geojson";


Â Â // ========= Utils =========

Â Â function stripDiacritics(str) {

Â Â Â Â try { return str.replace(new RegExp("\\\\p{Diacritic}+","gu"), ""); }

Â Â Â Â catch { return str.replace(/[\u0300-\u036f]+/g, ""); }

Â Â }

Â Â function normalize(s) {

Â Â Â Â return stripDiacritics(String(s).toLowerCase().normalize("NFD"))

Â Â Â Â Â Â .replace(/[^a-z\s]/g, "").replace(/\s+/g, " ").trim();

Â Â }

Â Â const PROV_SYNONYMS = {

Â Â Â Â "caba": "Ciudad AutÃ³noma de Buenos Aires",

Â Â Â Â "capital federal": "Ciudad AutÃ³noma de Buenos Aires",

Â Â Â Â "buenos aires": "Buenos Aires",

Â Â Â Â "catamarca": "Catamarca",

Â Â Â Â "chaco": "Chaco",

Â Â Â Â "chubut": "Chubut",

Â Â Â Â "cordoba": "CÃ³rdoba",

Â Â Â Â "corrientes": "Corrientes",

Â Â Â Â "entre rios": "Entre RÃ­os",

Â Â Â Â "formosa": "Formosa",

Â Â Â Â "jujuy": "Jujuy",

Â Â Â Â "la pampa": "La Pampa",

Â Â Â Â "la rioja": "La Rioja",

Â Â Â Â "mendoza": "Mendoza",

Â Â Â Â "misiones": "Misiones",

Â Â Â Â "neuquen": "NeuquÃ©n",

Â Â Â Â "rio negro": "RÃ­o Negro",

Â Â Â Â "salta": "Salta",

Â Â Â Â "san juan": "San Juan",

Â Â Â Â "san luis": "San Luis",

Â Â Â Â "santa cruz": "Santa Cruz",

Â Â Â Â "santa fe": "Santa Fe",

Â Â Â Â "santiago del estero": "Santiago del Estero",

Â Â Â Â "tierra del fuego": "Tierra del Fuego, AntÃ¡rtida e Islas del AtlÃ¡ntico Sur",

Â Â Â Â "tucuman": "TucumÃ¡n",

Â Â };


Â Â // ========= Estado =========

Â Â let features = [];

Â Â let status = {};

Â Â let selectedId = null;

Â Â let selectedName = "";

Â Â let hits = 0;


Â Â // ========= DOM =========

Â Â const mapBox = document.getElementById("map");

Â Â const answer = document.getElementById("answer");

Â Â const checkBtn = document.getElementById("checkBtn");

Â Â const resetBtn = document.getElementById("resetBtn");

Â Â const hitsEl = document.getElementById("hits");

Â Â const totalEl = document.getElementById("total");

Â Â const msgEl = document.getElementById("msg");

Â Â const geoUrlInput = document.getElementById("geoUrl");

Â Â const loadBtn = document.getElementById("loadBtn");

Â Â const errEl = document.getElementById("err");

Â Â const fileInput = document.getElementById("geoFile");

Â Â const btnPlus = document.getElementById("btnPlus");

Â Â const btnMinus = document.getElementById("btnMinus");

Â Â const btnReset = document.getElementById("btnReset");


Â Â // ========= SVG / D3 =========

Â Â let svg, g, path, projection, zoom, currentTransform;

Â Â function initSvg() {

Â Â Â Â mapBox.innerHTML = mapBox.innerHTML; // deja los botones

Â Â Â Â const svgEl = d3.select(mapBox).append("svg");

Â Â Â Â svg = svgEl;

Â Â Â Â g = svg.append("g");

Â Â Â Â projection = d3.geoMercator();

Â Â Â Â path = d3.geoPath(projection);

Â Â Â Â currentTransform = d3.zoomIdentity;


Â Â Â Â const w = mapBox.clientWidth, h = mapBox.clientHeight;

Â Â Â Â svg.attr("viewBox", `0 0 ${w} ${h}`);


Â Â Â Â zoom = d3.zoom().scaleExtent([0.8, 8]).on("zoom", (ev) => {

Â Â Â Â Â Â currentTransform = ev.transform;

Â Â Â Â Â Â g.attr("transform", currentTransform);

Â Â Â Â });

Â Â Â Â svg.call(zoom, currentTransform).on("dblclick.zoom", null);

Â Â }


Â Â function drawMap(geojson) {

Â Â Â Â features = geojson.features || [];

Â Â Â Â totalEl.textContent = features.length;


Â Â Â Â // Ajuste inicial

Â Â Â Â const w = mapBox.clientWidth, h = mapBox.clientHeight;

Â Â Â Â projection.fitSize([w, h], geojson);


Â Â Â Â const areas = g.selectAll("path").data(features, d => d.properties?.id || d.id);

Â Â Â Â areas.enter().append("path")

Â Â Â Â Â Â .attr("d", path)

Â Â Â Â Â Â .attr("fill", d => colorFor(d))

Â Â Â Â Â Â .attr("stroke", "#1e293b")

Â Â Â Â Â Â .attr("stroke-width", 1.2)

Â Â Â Â Â Â .attr("vector-effect", "non-scaling-stroke")

Â Â Â Â Â Â .style("cursor", "pointer")

Â Â Â Â Â Â .on("click", (_, d) => {

Â Â Â Â Â Â Â Â selectedId = d.properties?.id || d.id;

Â Â Â Â Â Â Â Â selectedName = d.properties?.nombre || d.properties?.name || "";

Â Â Â Â Â Â Â Â msgEl.textContent = `Provincia seleccionada: ${selectedName}.`;

Â Â Â Â Â Â Â Â answer.focus(); updateColors();

Â Â Â Â Â Â });


Â Â Â Â updateColors();

Â Â }


Â Â function colorFor(d) {

Â Â Â Â const id = d.properties?.id || d.id;

Â Â Â Â const st = status[id];

Â Â Â Â if (st === "correct") return "var(--ok)";

Â Â Â Â if (st === "wrong") return "var(--bad)";

Â Â Â Â if (id === selectedId) return "#93c5fd";

Â Â Â Â return "var(--idle)";

Â Â }

Â Â function updateColors() {

Â Â Â Â g.selectAll("path")

Â Â Â Â Â Â .attr("fill", d => colorFor(d))

Â Â Â Â Â Â .attr("stroke", d => (status[d.properties?.id || d.id] ? "var(--line-strong)" : "var(--line)"));

Â Â }

Â Â function resetGame() {

Â Â Â Â status = {}; selectedId = null; selectedName = "";

Â Â Â Â hits = 0; hitsEl.textContent = hits; msgEl.textContent = ""; answer.value = "";

Â Â Â Â updateColors();

Â Â Â Â // reset zoom

Â Â Â Â svg.transition().duration(200).call(zoom.transform, d3.zoomIdentity);

Â Â }


Â Â // ========= ComprobaciÃ³n =========

Â Â function checkAnswer() {

Â Â Â Â if (!selectedId) { msgEl.textContent = "TocÃ¡ primero una provincia del mapa."; answer.focus(); return; }

Â Â Â Â const userNorm = normalize(answer.value);

Â Â Â Â const canonical = PROV_SYNONYMS[userNorm] || answer.value.trim();

Â Â Â Â const isCorrect = normalize(canonical) === normalize(selectedName);

Â Â Â Â const prev = status[selectedId];

Â Â Â Â status[selectedId] = isCorrect ? "correct" : "wrong";

Â Â Â Â if (isCorrect) {

Â Â Â Â Â Â if (prev !== "correct") { hits++; hitsEl.textContent = hits; }

Â Â Â Â Â Â msgEl.textContent = `Â¡Correcto! Es ${selectedName}.`;

Â Â Â Â } else { msgEl.textContent = "No. IntentÃ¡ de nuevo."; }

Â Â Â Â answer.value = ""; answer.focus(); updateColors();

Â Â Â Â if (hits === features.length) msgEl.textContent = "Â¡Felicitaciones! Completaste todas las provincias.";

Â Â }


Â Â // ========= Carga de datos =========

Â Â async function loadFromUrl(url) {

Â Â Â Â errEl.textContent = "";

Â Â Â Â try {

Â Â Â Â Â Â const res = await fetch(url, { cache: "no-store" });

Â Â Â Â Â Â if (!res.ok) throw new Error(`HTTP ${res.status}`);

Â Â Â Â Â Â const data = await res.json();

Â Â Â Â Â Â if (!data || !data.type) throw new Error("Formato no vÃ¡lido");

Â Â Â Â Â Â if (data.type === "Topology") { throw new Error("SubÃ­/pegÃ¡ un GeoJSON (TopoJSON no soportado aquÃ­)."); }

Â Â Â Â Â Â initSvg(); drawMap(data);

Â Â Â Â } catch (e) { errEl.textContent = e.message || "No se pudo cargar el archivo/URL."; }

Â Â }

Â Â function loadFromFile(file) {

Â Â Â Â errEl.textContent = "";

Â Â Â Â const reader = new FileReader();

Â Â Â Â reader.onload = () => {

Â Â Â Â Â Â try {

Â Â Â Â Â Â Â Â const data = JSON.parse(reader.result);

Â Â Â Â Â Â Â Â if (!data || !data.type) throw new Error("Archivo JSON no es GeoJSON vÃ¡lido.");

Â Â Â Â Â Â Â Â if (data.type === "Topology") throw new Error("Archivo TopoJSON detectado. ConvertÃ­ a GeoJSON.");

Â Â Â Â Â Â Â Â initSvg(); drawMap(data);

Â Â Â Â Â Â } catch (e) { errEl.textContent = e.message || "Archivo invÃ¡lido."; }

Â Â Â Â };

Â Â Â Â reader.onerror = () => errEl.textContent = "No se pudo leer el archivo.";

Â Â Â Â reader.readAsText(file);

Â Â }


Â Â // ========= Eventos =========

Â Â checkBtn.addEventListener("click", checkAnswer);

Â Â answer.addEventListener("keydown", (e) => { if (e.key === "Enter") { e.preventDefault(); checkAnswer(); }});

Â Â resetBtn.addEventListener("click", resetGame);

Â Â loadBtn.addEventListener("click", () => { const u = geoUrlInput.value.trim(); if (u) loadFromUrl(u); });

Â Â geoUrlInput.addEventListener("keydown", (e) => {

Â Â Â Â if (e.key === "Enter") { e.preventDefault(); const u = geoUrlInput.value.trim(); if (u) loadFromUrl(u); }

Â Â });

Â Â fileInput.addEventListener("change", (e) => { const f = e.target.files?.[0]; if (f) loadFromFile(f); });


Â Â // Zoom buttons

Â Â btnPlus.addEventListener("click", () => svg.transition().duration(200).call(zoom.scaleBy, 1.3));

Â Â btnMinus.addEventListener("click", () => svg.transition().duration(200).call(zoom.scaleBy, 1/1.3));

Â Â btnReset.addEventListener("click", () => svg.transition().duration(200).call(zoom.transform, d3.zoomIdentity));


Â Â // Redibujar al rotar/resize

Â Â window.addEventListener("resize", () => {

Â Â Â Â if (!features.length) return;

Â Â Â Â const w = mapBox.clientWidth, h = mapBox.clientHeight;

Â Â Â Â svg.attr("viewBox", `0 0 ${w} ${h}`);

Â Â Â Â projection.fitSize([w, h], { type:"FeatureCollection", features });

Â Â Â Â g.selectAll("path").attr("d", path);

Â Â }, { passive: true });


Â Â // Init

Â Â (async function start(){ await loadFromUrl(DEFAULT_GEOJSON_URL); })();


Â Â // Tests rÃ¡pidos en consola

Â Â (function runDevTests() {

Â Â Â Â const tests = [

Â Â Â Â Â Â { in: "CÃ³rdoba", out: "cordoba" },

Â Â Â Â Â Â { in: "San Â  Juan", out: "san juan" },

Â Â Â Â Â Â { in: " Â  RÃ­o Â  Negro!!!Â  ", out: "rio negro" },

Â Â Â Â Â Â { in: "TucumÃ¡n", out: "tucuman" },

Â Â Â Â Â Â { in: "Ciudad AutÃ³noma de Buenos Aires", out: "ciudad autonoma de buenos aires" },

Â Â Â Â ];

Â Â Â Â tests.forEach((t, i) => {

Â Â Â Â Â Â const got = normalize(t.in);

Â Â Â Â Â Â if (got !== t.out) console.error(`Test normalize #${i+1} FALLÃ“: esperado='${t.out}', obtenido='${got}'`);

Â Â Â Â Â Â else console.log(`Test normalize #${i+1} OK`);

Â Â Â Â });

Â Â })();

Â Â </script>

</body>

</html>

